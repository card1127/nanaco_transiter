# 概要
このスクリプトでは、PythonでSeleniumを使用し、nanacoギフトコード登録するまでを自動化します。
nanacoギフトコードを福利厚生倶楽部で購入した場合、ギフトコードの取得も自動的に行います。
※ギフトコードを取得する環境は福利厚生倶楽部でテストしました。その他の場所で購入したギフトコードはテストしていませんのでご注意ください。

# 最近のUPDATE
- 重複して登録した場合、Dupulicatedと表示されるようになった
- 登録に失敗した場合、成功するまで最大で5回繰り返すようになった
- nanacoギフトコードをURLから取得せず、直接指定できるようになった

# 環境
- Chrome
- Python3
- Selenium
- Selenium Chrome Webdriver

# スクリプト実行までの準備(初回限定)
1. cloneします。
    ```
    git clone https://github.com/card1127/nanaco_transiter.git
    ```

1. [最新のPython3](https://www.python.org/downloads/)をインストールします。すでにインストールされている場合は次の手順に進んでください。

1. [最新のChrome](https://www.google.co.jp/chrome/)をインストールします。すでにインストール済みの場合は次の手順に進んでください。

1. 追加ライブラリをインストールします。Windowsならコマンドプロンプト、Macならターミナルで下記コマンドを実行してください。
※環境に応じて`pip`または`pip3`で実行してください。
    ```
    pip3 install selenium
    pip3 install chromedriver-binary
    ```

1. 福利厚生倶楽部のIDやnanaco番号などをスクリプトに記載します。この手順をスキップした場合、実行時に尋ねられるのでそこで入力しても問題ありません。

# 実行方法
Windowsならコマンドプロンプト、Macならターミナルで下記コマンドを実行してください。
※環境に応じて`python`または`python3`で実行してください。
```
python3 nanaco_transiter.py "ギフトコードのURL"|"ギフトコード" ["ギフトコードのURL"|"ギフトコード" ...]
```

# 実行例
```
python3 nanaco_transiter.py https://www.fukuri.net/main/www/gift/login.jsp?jujuno=xxxxxxxxxx&cococd=xx da1Ddf2fffsd4589 fffsd4589da1Ddf2 https://www.fukuri.net/main/www/gift/login.jsp?jujuno=yyyyyyyyyy&cococd=yy
```
上記の場合、URL指定した2つのページよりnanacoギフトコードを取得し、ギフトコード指定した2つのギフトコードと合わせて登録を行います。

# 出力結果
スクリプトの進捗状況と、各ギフトコードの登録結果を表示します。
各ギフトコードの出力結果「ギフトコード 進捗度合い 登録結果」で表示されます。
表示例は次のとおりです。
```
abcdefgHIJ123456 (13/20) Succeeded
```
登録結果は以下の3種類で表示されます。
|登録結果|説明|
|:-|:-|
|Succeeded|登録に成功しました|
|Duplicated|すでに登録されています|
|Missed|5回試行しましたが、5回とも登録に失敗しました。正しいギフトコードかどうかとネットワーク環境を確認してください|

# その他
- 引数に何も入力せずに実行した場合、実行時に入力を求められます。ギフトコードが記載されてるURLか、ギフトコードを1行ずつ入力してください。
- 引数のURLは""で括る必要があります。括らない場合、文字列中の&をシェル命令の&と解釈されてしまい正しく動作しません。ギフトコードの場合は括らなくても問題ありません。
- 引数の場合も実行中に入力の場合も、ギフトコードとURLは混在して入力できます。
- ギフトコードの登録に失敗した場合、成功するまで最大5回繰り返します。全て失敗した場合、Missedと表示されます。
- 福利厚生倶楽部のIDの入力は必須です。全てギフトコードを入力した場合はテキトーな値を入力してください。
- 細かなエラー処理は実装していません。本来の使い方でご使用ください。
- ギフトコードの登録中に落ちてしまっても、再実行すれば問題なく登録できます。
- 不具合などありましたらご連絡いただけると助かります。

# 免責
- このスクリプトの実行は全て自己責任でお願いします。
- このスクリプトに悪意ある動作は含めていませんが、万一不具合によって実行者が被害を被ったとしても、作者は一切の責任を負いませんのでご注意ください。

# サポート
不具合の連絡や、新機能のご要望などあればここのissueか、Twitterアカウント(@nog_go)までお願いします。
